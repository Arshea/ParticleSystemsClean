// API Abstraction
#include "PrimeEngine/APIAbstraction/APIAbstractionDefines.h"

#include "ParticleManager.h"
// Outer-Engine includes

// Inter-Engine includes
#include "PrimeEngine/FileSystem/FileReader.h"
#include "PrimeEngine/APIAbstraction/GPUMaterial/GPUMaterialSet.h"
#include "PrimeEngine/PrimitiveTypes/PrimitiveTypes.h"
#include "PrimeEngine/APIAbstraction/Texture/Texture.h"
#include "PrimeEngine/APIAbstraction/Effect/EffectManager.h"
#include "PrimeEngine/APIAbstraction/GPUBuffers/VertexBufferGPUManager.h"
#include "PrimeEngine/../../GlobalConfig/GlobalConfig.h"

#include "PrimeEngine/Geometry/SkeletonCPU/SkeletonCPU.h"

#include "PrimeEngine/Scene/RootSceneNode.h"

#include "Light.h"

// Sibling/Children includes

#include "MeshInstance.h"
#include "Skeleton.h"
#include "SceneNode.h"
#include "DrawList.h"
#include "SH_DRAW.h"
#include "PrimeEngine/Lua/LuaEnvironment.h"



namespace PE {
	namespace Components {

		PE_IMPLEMENT_CLASS1(ParticleManager, Component);
		ParticleManager::ParticleManager(PE::GameContext &context, PE::MemoryArena arena, Handle hMyself)
			: Component(context, arena, hMyself)
		{
			pSysTest = ParticleSystem();
		}

		void ParticleManager::updateSystems(int &threadOwnershipMask) {
			pSysTest.update();
			print(threadOwnershipMask);
		}

		void ParticleManager::print(int &threadOwnershipMask) {
			ParticleRenderer::Instance()->createPSysMesh(
				pSysTest.getParticles(), 0, Vector3(0.0f, 0.0f, 0.0f), 0.01f, threadOwnershipMask);
		}

	}
}